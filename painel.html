<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <script>
    function verificarEIrParaMobile() {
        // 1. O detetive olha a "identidade" do aparelho
        const ehMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        
        // 2. O detetive olha o tamanho da tela (para pegar tablets pequenos ou celulares em p√©)
        const telaPequena = window.innerWidth <= 768;

        // Se for celular OU a tela for pequena...
        if (ehMobile || telaPequena) {
            // REDIRECIONA DIRETO PARA O SEU ARQUIVO MOBILE NOVO!
            window.location.replace("mobile.html"); 
        }
    }

    // Executa o detetive imediatamente antes da p√°gina terminar de carregar
    verificarEIrParaMobile();
</script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Amigo Virtual</title>
    <link rel="icon" type="image/x-icon" href="icon.ico">
<link rel="apple-touch-icon" href="icon.ico">
    <style>
        /* --- ESTILOS ORIGINAIS (MANTIDOS) --- */
        body { font-family: 'Segoe UI', sans-serif; background: #f4f6f8; margin: 0; color: #333; }
        .tela { display: none; padding: 20px; max-width: 1400px; margin: auto; }
        .tela.ativa { display: block; }
        .box-login { max-width: 400px; margin: 60px auto; background: white; padding: 40px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); text-align: center; }
        
        .main-grid { display: grid; grid-template-columns: 450px 1fr; gap: 20px; }
        @media (max-width: 1100px) { .main-grid { grid-template-columns: 1fr; } }
        
        .card { background: white; padding: 20px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.05); }
        h2 { margin-top: 0; border-bottom: 1px solid #eee; padding-bottom: 10px; font-size: 18px; color: #2c3e50; }
        
        .form-group { margin-bottom: 12px; }
        label { display: block; font-size: 11px; font-weight: bold; margin-bottom: 4px; text-transform: uppercase; color: #7f8c8d; }
        input, select { width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; font-size: 14px; margin-bottom: 15px; }
        
        /* LISTA DE SELE√á√ÉO (CHECKBOXES) */
        .devices-box { border: 1px solid #ddd; padding: 5px; border-radius: 6px; max-height: 150px; overflow-y: auto; background: #fff; }
        .device-label { display: flex; align-items: center; padding: 8px; border-bottom: 1px solid #eee; cursor: pointer; transition: 0.2s; width: 100%; box-sizing: border-box; }
        .device-label:hover { background: #f9f9f9; }
        .device-label input { width: 18px; height: 18px; margin: 0 10px 0 0; cursor: pointer; }
        
        /* MONITORAMENTO E GR√ÅFICO */
        .pc-status-card { background: #f8f9fa; border: 1px solid #e9ecef; border-radius: 8px; padding: 15px; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; }
        .pc-info h3 { margin: 0; font-size: 16px; color: #2c3e50; }
        .pc-badge { display: inline-block; padding: 3px 8px; border-radius: 12px; font-size: 11px; font-weight: bold; margin-top: 5px; }
        .badge-online { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .badge-offline { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; }
        .pc-timer { text-align: right;
    margin-right: 15px;
    min-width: 80px; /* Garante uma largura m√≠nima para o texto n√£o encavalar */
    display: flex;
    flex-direction: column;
    justify-content: center; }
        .pc-timer small { display: block; font-size: 10px; color: #6c757d; text-transform: uppercase; }
        .pc-timer span { font-size: 18px;
    font-weight: bold;
    color: #333;
    font-family: monospace;
    white-space: nowrap; /* Impede que o 'h' e 'm' fiquem em linhas diferentes */ }
        .btn-del-device { background: transparent; color: #ccc; border: none; font-size: 16px; cursor: pointer; padding: 5px; transition: 0.2s; }
        .btn-del-device:hover { color: #e74c3c; transform: scale(1.2); }

        .grafico-container { display: flex; align-items: flex-end; gap: 10px; height: 120px; padding-top: 25px; overflow-x: auto; }
        .barra-wrapper { display: flex; flex-direction: column; align-items: center; width: 40px; }
        .barra { width: 20px; background: #3498db; border-radius: 4px 4px 0 0; transition: height 0.5s; }
        .barra:hover { background: #2980b9; }
        .barra-valor { font-size: 10px; font-weight: bold; margin-bottom: 2px; }
        .barra-dia { font-size: 10px; color: #888; margin-top: 5px; }

        button { padding: 12px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; width: 100%; color: white; transition: 0.2s; margin-bottom: 10px;}
        .btn-blue { background: #3498db; } .btn-green { background: #2ecc71; } 
        .btn-red { background: #e74c3c; width: auto; padding: 4px 10px; font-size: 12px; }
        .btn-trash { background: #c0392b; width: auto; padding: 8px 12px; margin-left: 5px; border-radius: 6px; }
        .btn-edit { background: #f1c40f; width: auto; padding: 4px 10px; font-size: 12px; color: #333; margin-right: 5px; }
        button:last-child {
    margin-bottom: 0;
}
        .aviso-container { background: #f9fbfd; border: 1px solid #e1e8ed; padding: 10px; border-radius: 8px; margin-bottom: 10px; }
        .aviso-titulo { font-size: 12px; font-weight: bold; color: #3498db; margin-bottom: 5px; display: block; }
        
        .switch-row { display: flex; align-items: center; justify-content: space-between; margin-bottom: 8px; background: #fff; padding: 8px; border: 1px solid #eee; border-radius: 6px; }
        .switch { position: relative; display: inline-block; width: 40px; height: 20px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #ccc; transition: .4s; border-radius: 34px; }
        .slider:before { position: absolute; content: ""; height: 16px; width: 16px; left: 2px; bottom: 2px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .slider { background-color: #2ecc71; }
        input:checked + .slider:before { transform: translateX(20px); }
        
        .lista-container { max-height: 300px; overflow-y: auto; margin-top: 10px; }
        li { background: #fff; border-bottom: 1px solid #eee; padding: 8px; display: flex; justify-content: space-between; align-items: center; }
        .img-mini { width: 30px; height: 30px; object-fit: contain; margin-right: 10px; border-radius: 4px; border: 1px solid #eee; }
        
        .calendario-wrapper { overflow-x: auto; white-space: nowrap; margin-top: 10px; }
        .dia-coluna { display: inline-block; width: 130px; vertical-align: top; background: #fff; margin-right: 8px; padding: 5px; border-radius: 8px; min-height: 150px; white-space: normal; border: 1px solid #eee; }
        .card-rotina { background: #f0f8ff; border-left: 3px solid #3498db; padding: 6px; margin-bottom: 5px; border-radius: 4px; font-size: 12px; position: relative; }

        .timeline-box { margin-top: 20px; padding: 10px; background: #fff; border-radius: 10px; border: 1px solid #e0e0e0; max-height: 500px; overflow-y: auto; }
        .tl-item { display: flex; align-items: center; margin-bottom: 15px; position: relative; transition: all 0.3s; padding: 10px; border-radius: 8px; background: white; border: 1px solid #eee; }
        .tl-item::before { content: ''; position: absolute; left: 35px; top: -15px; bottom: -15px; width: 2px; background: #ddd; z-index: 0; }
        .tl-item:first-child::before { top: 50%; } .tl-item:last-child::before { bottom: 50%; }
        .tl-time { width: 50px; text-align: center; background: #3498db; color: white; padding: 5px; border-radius: 12px; font-size: 12px; font-weight: bold; z-index: 1; margin-right: 15px; }
        .tl-content { flex: 1; display: flex; align-items: center; z-index: 1; }
        .tl-img { width: 40px; height: 40px; border-radius: 50%; object-fit: contain; margin-right: 10px; background: #f9f9f9; border: 1px solid #eee; }
        .tl-text b { display: block; color: #444; font-size: 14px; }
        .tl-text span { font-size: 12px; color: #888; }
        .tl-item.passado { opacity: 0.5; filter: grayscale(100%); }
        .tl-item.passado .tl-time { background: #95a5a6; }
        .tl-item.proximo { border: 2px solid #e67e22; box-shadow: 0 4px 15px rgba(230, 126, 34, 0.2); animation: pulse 2s infinite; transform: scale(1.02); }
        .tl-item.proximo .tl-time { background: #e67e22; font-size: 14px; padding: 8px; }
        .tl-item.proximo b { color: #e67e22; font-size: 16px; }
        @keyframes pulse { 0% { box-shadow: 0 0 0 0 rgba(230, 126, 34, 0.4); } 70% { box-shadow: 0 0 0 10px rgba(230, 126, 34, 0); } 100% { box-shadow: 0 0 0 0 rgba(230, 126, 34, 0); } }

        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 2000; display: none; justify-content: center; align-items: center; }
        .modal-overlay.aberta { display: flex; }
        .modal-content { background: white; width: 90%; max-width: 600px; max-height: 80vh; border-radius: 12px; padding: 30px; box-shadow: 0 10px 25px rgba(0,0,0,0.2); overflow-y: auto; border-top: 5px solid #f1c40f; }
        .dica-item { margin-bottom: 20px; border-bottom: 1px solid #eee; padding-bottom: 15px; }
        .dica-titulo { color: #2c3e50; font-size: 16px; font-weight: bold; display: flex; align-items: center; margin-bottom: 5px; }
        .btn-fechar-modal { background: #eee; color: #333; border: none; padding: 10px 20px; border-radius: 6px; cursor: pointer; font-weight: bold; float: right; }

     /* Container da Galeria */
.galeria-v { 
    display: grid; 
    grid-template-columns: repeat(auto-fill, minmax(75px, 1fr)); 
    gap: 10px; 
    background: #fff; 
    border: 1px solid #ddd; 
    padding: 12px; 
    border-radius: 8px; 
    max-height: 200px; 
    overflow-y: auto; 
}

/* Estilo de cada √≠cone */
.img-sel { 
    width: 100%; 
    aspect-ratio: 1; 
    object-fit: contain; 
    border: 2px solid #eee; 
    border-radius: 8px; 
    cursor: pointer; 
    transition: 0.2s; 
    display: none; /* Come√ßa escondida para n√£o mostrar erro */
}

/* Quando a imagem for encontrada, ela se torna vis√≠vel */
.img-sel.visivel { display: block; }

/* Destaque ao clicar */
.img-sel.ativa { border-color: #2ecc71; background: #eafaf1; box-shadow: 0 0 8px rgba(46, 204, 113, 0.3); }
        @media (max-width: 768px) {
            .main-grid { grid-template-columns: 1fr !important; gap: 15px; }
            .box-login { margin: 20px auto; padding: 25px; width: 90%; }
            #telaDashboard > div:first-child { flex-direction: column; align-items: flex-start; gap: 15px; }
            #telaDashboard > div:first-child > div { width: 100%; justify-content: space-between; }
            input, select, button { font-size: 16px !important; min-height: 45px; }
            .btn-edit, .btn-red, .btn-trash { padding: 10px 15px; }
            .device-label { padding: 12px; }
            .calendario-wrapper { padding-bottom: 20px; -webkit-overflow-scrolling: touch; }
            .dia-coluna { min-width: 160px; } 
            .timeline-box { max-height: none; overflow: visible; }
            .modal-content { width: 95%; max-height: 90vh; padding: 20px; }
        }

        /* Container dos controles do Filho */
.grupo-filho {
    display: flex;
    align-items: center; /* Alinha verticalmente ao centro */
    gap: 5px; /* Espa√ßo entre os bot√µes */
}

/* For√ßa a altura e remove margens que atrapalham o alinhamento */
.grupo-filho select,
.grupo-filho button {
    height: 38px !important; /* Altura fixa igual para todos */
    margin: 0 !important;    /* Remove margens externas */
    padding: 0 10px;         /* Espa√ßamento interno */
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 14px;
}
/* --- ESTILO DA NOTIFICA√á√ÉO (TOAST) --- */
        #toast-aviso {
            visibility: hidden;
            min-width: 250px;
            background-color: white;
            color: #93C49D; /* Verde do seu tema */
            text-align: center;
            border: 2px solid #93C49D;
            border-radius: 30px;
            padding: 15px 20px;
            position: fixed;
            z-index: 99999;
            left: 50%;
            top: 20px; /* Come√ßa l√° embaixo */
            transform: translateX(-50%);
            font-size: 16px;
            font-weight: bold;
            box-shadow: 0 5px 15px rgba(147, 196, 157, 0.3);
            opacity: 0;
            transition: opacity 0.4s, bottom 0.4s;
        }

        /* Classe que o Javascript vai adicionar para fazer ele aparecer e subir */
        #toast-aviso.mostrar {
            visibility: visible;
            opacity: 1;
            top: 50px; /* Sobe um pouquinho na anima√ß√£o */
        }
/* Ajuste espec√≠fico para o texto "Filho:" */
.grupo-filho span {
    margin-right: 5px;
    font-weight: bold;
    color: #555;
}

.container-esqueci-senha {
    text-align: center;
    margin-top: 15px;
    margin-bottom: 20px;
}

.link-esqueci-senha {
    color: #7f8c8d; /* Cinza elegante */
    font-size: 14px;
    text-decoration: none;
    transition: all 0.3s ease;
    font-weight: 500;
    cursor: pointer;
}

.link-esqueci-senha:hover {
    color: #2ECC71; /* Fica da cor do seu tema ao passar o mouse */
    text-decoration: underline;
}

.menu-topo-login {
    position: absolute; 
    top: 20px;
    left: 30px;
    z-index: 100;
}

.btn-voltar-home {
    text-decoration: none;
    color: #555; /* Cinza escuro elegante */
    font-weight: 600;
    font-size: 14px;
    display: inline-flex;
    align-items: center;
    gap: 8px; /* Espa√ßo exato entre o √≠cone e o texto */
    padding: 10px 20px;
    background-color: white;
    border: 1px solid #e1e8ed;
    border-radius: 30px; /* Deixa o bot√£o redondinho (p√≠lula) */
    transition: all 0.3s ease;
    box-shadow: 0 2px 8px rgba(0,0,0,0.04); /* Sombra bem suave */
}

/* O √≠cone SVG */
.btn-voltar-home svg {
    width: 18px;
    height: 18px;
    transition: transform 0.3s ease;
}

/* O efeito m√°gico de passar o mouse */
.btn-voltar-home:hover {
    color: #3498db; /* Fica azul */
    border-color: #3498db;
    box-shadow: 0 4px 12px rgba(52, 152, 219, 0.15); /* Sombra azulada */
}

.btn-voltar-home:hover svg {
    transform: translateX(-4px); /* A seta d√° um pulinho pra esquerda */
}

    </style>
</head>
<body>
    <div class="menu-topo-login">
    <a href="index.html" class="btn-voltar-home">
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
            <path d="M15 19L8 12L15 5" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
        </svg>
        Voltar para o In√≠cio
    </a>
</div>
<div id="toast-aviso">ü§ñ A√ß√£o enviada para o dispositivo!</div>
   
    <div id="telaLogin" class="tela ativa">
        <div class="box-login">
            <h1>üîê Amigo Virtual</h1>
            <input type="email" id="emailInput" placeholder="Digite seu e-mail">

<div style="position: relative; width: 100%;  display: block; margin-bottom: 15px;">
    
    <input type="password" id="senhaInput" placeholder="Digite sua senha" style="width: 100%; box-sizing: border-box; padding-right: 45px;">
    
    <button type="button" id="btnOlhinho" onclick="toggleSenha()" style=" position: absolute; left: 45%; top: 35%; transform: translateY(-50%); background: none; border: none; cursor: pointer; font-size: 18px; padding: 0; outline: none; z-index: 10;">üëÅÔ∏è</button>

</div>
            <div class="container-esqueci-senha">
    <a href="#" id="btnEsqueciSenha" class="link-esqueci-senha">ü§î Esqueceu a senha? Clique aqui</a>
</div>
            <button class="btn-blue" onclick="fazerLogin()">Entrar</button>
            <button class="btn-green" onclick="criarConta()" style="margin-top:10px">Criar Nova Conta</button>
        </div>
    </div>

    <div id="telaDashboard" class="tela">
        <div style="display:flex; justify-content:space-between; margin-bottom:20px; background:white; padding:15px; border-radius:12px; align-items:center;">
            <div class="grupo-filho">
    <span>Filho:</span> 
    <select id="selectFilho" onchange="mudarFilho()" style="width: 200px;"></select> 
    <button onclick="novoFilho()" class="btn-green" title="Adicionar"style="width: 50px;">+</button>
    <button onclick="excluirFilho()" class="btn-trash" title="Excluir"style="width: 50px;">üóëÔ∏è</button>
</div>
            <div>
                <button onclick="abrirDicas()" style="width:auto; background:#f1c40f; color:#333; padding:6px 15px; font-size:12px; margin-right:5px; font-weight:bold;">üí° Dicas para Pais</button>
                <span style="background:#fffbe6; padding:6px 12px; border:1px solid #ffe58f; border-radius:20px; font-weight:bold; margin-right:10px; color:#d4ac0d">C√ìDIGO: <span id="displayCodigo">...</span></span>
                <button onclick="sair()" style="width:auto; background:#e74c3c; padding:6px 15px; font-size:12px">Sair</button>
            </div>
        </div>

        <div class="main-grid">
            
            <div>
                <div class="card">
                    <h2>üé® Criar / Editar Atividade</h2>
                    <input type="hidden" id="editIdAtividade">
                    <div style="display:flex; gap:10px">
                        <div class="form-group" style="flex:2"><label>ID (Nome Curto)</label><input type="text" id="idAtividade" placeholder="ex: banho"></div>
                        <div class="form-group" style="flex:1"><label>Tempo (s)</label><input type="number" id="tempoAtividade" placeholder="15"></div>
                    </div>
                    <div class="form-group"><label>Texto Principal</label><input type="text" id="txtAtividade"></div>
                    
               <div class="form-group">
    <label>üñºÔ∏è Escolha a Imagem </label>
    <div id="galVisual" class="galeria-v"></div> <input type="text" id="imgAtividade" oninput="atualizarPreview()" placeholder="Caminho do arquivo">
</div>

                    <div class="form-group" style="background:#fff; padding:15px; border:1px solid #ddd; border-radius:6px; text-align:center;">
                        <label style="margin-bottom:10px; display:block; text-align:left">üìê Tamanho: <span id="labelTamanho" style="color:#2980b9; font-weight:bold">150px</span></label>
                        <input type="range" id="rangeTamanho" min="50" max="500" value="150" oninput="atualizarPreview()" style="width:100%; cursor:pointer; margin-bottom:10px;">
                        <div style="min-height: 100px; border: 1px dashed #ccc; background-image: radial-gradient(#eee 1px, transparent 1px); background-size: 10px 10px; display: flex; align-items: center; justify-content: center; overflow: hidden; border-radius: 4px;">
                            <img id="previewAvatar" src="" style="width: 150px; transition: width 0.1s;">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>üì± Onde exibir? (Online = üü¢)</label>
                        <div class="devices-box" id="listaDispositivos"><div style="padding:10px; color:#999">Aguardando PC...</div></div>
                    </div>

                    <div class="aviso-container"><span class="aviso-titulo">üïí Aviso de 5 Minutos</span><input type="text" id="txt5min" placeholder="Texto" style="margin-bottom:5px"><input type="text" id="img5min" placeholder="Imagem"></div>
                    <div class="aviso-container"><span class="aviso-titulo">üïí Aviso de 3 Minutos</span><input type="text" id="txt3min" placeholder="Texto" style="margin-bottom:5px"><input type="text" id="img3min" placeholder="Imagem"></div>

                    <div class="form-group"><label>üìç Posi√ß√£o</label>
                        <select id="posAtividade"><option value="">Padr√£o Geral</option><option value="top-left">‚Üñ Topo Esquerda</option><option value="top-center">‚¨Ü Topo Centro</option><option value="top-right">‚Üó Topo Direita</option><option value="center">‚è∫ Centro da Tela</option><option value="bottom-left">‚Üô Baixo Esquerda</option><option value="bottom-center">‚¨á Baixo Centro</option><option value="bottom-right">‚Üò Baixo Direita</option></select>
                    </div>

                    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px; background:#f9f9f9; padding:10px; border-radius:10px; flex-wrap:wrap; gap:10px;">
    <div style="font-size:12px; font-weight:bold; color:#555">Ler Voz? <label class="switch" style="vertical-align:middle; margin-left:5px"><input type="checkbox" id="checkVoz" checked><span class="slider"></span></label></div>
    
    <div style="font-size:12px; font-weight:bold; color:#555">Voz: 
        <select id="generoVoz" style="padding:4px; border-radius:6px; border:1px solid #ddd; margin-left:5px;">
            <option value="M">üë¶ Menino</option>
            <option value="F">üëß Menina</option>
        </select>
    </div>

    <div style="font-size:12px; font-weight:bold; color:#555">Bloquear? <label class="switch" style="vertical-align:middle; margin-left:5px"><input type="checkbox" id="checkBlock"><span class="slider"></span></label></div>
</div>
                    <div style="display:flex; gap:10px; margin-top:15px">
                        <button class="btn-blue" onclick="salvarAtividade()">üíæ Salvar Atividade</button>
                        <button style="background:#95a5a6; color:white" onclick="limparFormAtividade()">Limpar</button>
                    </div>
                    <div class="lista-container"><ul id="listaAtividades" style="padding:0; list-style:none"></ul></div>
                </div>
            </div>

            <div>
                <div class="card" style="border-top: 5px solid #27ae60;">
                    <h2>üñ•Ô∏è Computadores (Monitoramento)</h2>
                    <div id="painelMonitoramento">
                        <p style="text-align:center; color:#999; font-size:13px;">Carregando status...</p>
                    </div>
                </div>

                <div class="card" style="border-top: 5px solid #3498db;">
                    <h2 id="tituloHistorico">üìä Hist√≥rico de Uso</h2>
                    <div id="graficoHistorico" class="grafico-container">
                        <small style="color:#999">Aguardando dados...</small>
                    </div>
                </div>

                <div class="card">
                    <h2>üìÖ Agendar Rotina</h2>
                    <input type="hidden" id="editIdRotina">
                    <div style="background:#f0f4f8; padding:15px; border-radius:8px; display:flex; gap:5px; align-items:flex-end; flex-wrap:wrap">
                        <div style="flex:1"><label>Hora</label><input type="time" id="horaRotina"></div>
                        <div style="flex:1"><label>Dia</label><select id="diaRotina"><option value="todos">Todos</option><option value="1">Seg</option><option value="2">Ter</option><option value="3">Qua</option><option value="4">Qui</option><option value="5">Sex</option><option value="6">S√°b</option><option value="0">Dom</option></select></div>
                        <div style="flex:2"><label>Atividade</label><select id="selectAtividadeRotina"></select></div>
                        <div><button class="btn-green" style="padding:10px 20px; margin-bottom:1px" onclick="salvarRotina()">OK</button></div>
                    </div>
                    <div class="calendario-wrapper"><div id="calendarioContainer"></div></div>
                </div>

                <div class="card" style="border-top: 5px solid #8e44ad;">
                    <h2>üó∫Ô∏è Mapa do Dia (Hoje)</h2>
                    <div id="timelineInteligente" class="timeline-box">
                        <div style="text-align:center; color:#888;">Carregando roteiro...</div>
                    </div>
                </div>

                <div class="card">
                    <h2>üéÆ A√ß√µes Manuais</h2>
                    <div id="gridAcoes" style="display:grid; grid-template-columns:repeat(auto-fill, minmax(80px, 1fr)); gap:10px"></div>
                    <div style="display:flex; gap:10px; margin-top:15px;">
                        <button onclick="enviarAcao('livre')" style="flex:1; background:#95a5a6;">üîì LIBERAR</button>
                        <button onclick="enviarAcao('bloqueio')" style="flex:1; background:#c0392b;">üîí BLOQUEAR</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="modalDicas" class="modal-overlay">
        <div class="modal-content">
            <h2 style="margin-top:0">üí° 5 Pilares da Rotina no Autismo</h2>
            <div class="dica-item"><div class="dica-titulo"><span class="dica-icone">üîÆ</span> 1. Antecipa√ß√£o</div><div class="dica-texto">Use os avisos de 5 e 3 minutos.</div></div>
            <button class="btn-fechar-modal" onclick="fecharDicas()">Fechar</button>
        </div>
    </div>

    <script type="module">
        
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js";
        import { getFirestore, doc, setDoc, getDoc, collection, addDoc, onSnapshot, deleteDoc, updateDoc, query, orderBy, limit } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore.js";
        import { getAuth, createUserWithEmailAndPassword, sendPasswordResetEmail, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js";

        const firebaseConfig = { apiKey: "AIzaSyAh3J8bp7xvNGct8k4TfAoCcIpVRoWjBYI", authDomain: "rotinaeduardo.firebaseapp.com", projectId: "rotinaeduardo", storageBucket: "rotinaeduardo.firebasestorage.app", messagingSenderId: "210945268922", appId: "1:210945268922:web:ce9e585872090b378d7683", measurementId: "G-MDYWRH9RNP" };
        const app = initializeApp(firebaseConfig); const db = getFirestore(app); const auth = getAuth(app);
        let usuarioAtual, filhoAtualId, cacheAtividades={}, cacheRotinas={}, unsubscribeAtividades, unsubscribeRotinas, unsubscribeDispositivos, unsubscribeHistorico;

       

       // A fun√ß√£o agora tem a palavra "async" na frente para o seguran√ßa poder aguardar a resposta do banco
window.fazerLogin = async function(event) {
    // 1. Trava a p√°gina para ela n√£o dar aquele "piscar" e recarregar
    if (event) event.preventDefault(); 

    try {
        // 2. O detector inteligente de caixinhas (pega o ID que voc√™ tiver usado)
        const campoEmail = document.getElementById('emailInput') || document.getElementById('email');
        const campoSenha = document.getElementById('senhaInput') || document.getElementById('senha');

        // Se ele n√£o achar a caixinha de jeito nenhum, ele te avisa na tela!
        if (!campoEmail || !campoSenha) {
            alert("ERRO NO HTML: O c√≥digo n√£o encontrou as caixinhas de e-mail e senha!");
            return;
        }

        const email = campoEmail.value;
        const senha = campoSenha.value;

        // 3. Tenta fazer o login
        const credenciais = await signInWithEmailAndPassword(auth, email, senha);
        const user = credenciais.user;

        // 4. O Seguran√ßa vai no Firestore
        const db = getFirestore(app);
        const docRef = doc(db, "assinaturas", user.uid);
        const docSnap = await getDoc(docRef);

        // 5. Analisa a ficha e abre a catraca
        if (docSnap.exists()) {
            const statusAssinatura = docSnap.data().status;

            if (statusAssinatura === "ativo") {
                window.location.replace("painel.html"); 
            } else {
                window.location.replace("bloqueado.html");
            }
        } else {
            window.location.replace("bloqueado.html");
        }

    } catch (error) {
        // Se a senha estiver errada ou der algum erro no Firebase, ele avisa aqui
        alert("Erro ao entrar: Verifique seu e-mail e senha.");
        console.error("Detalhe do erro:", error);
    }
};
window.criarConta = async () => {
    // 1. Pega os valores dos inputs
    const email = document.getElementById('email').value;
    const senha = document.getElementById('senha').value;

    try {
        // 2. Tenta criar o usu√°rio
       const userCredential = await createUserWithEmailAndPassword(auth, email, senha);
        const user = userCredential.user;

        // Isso aqui cria a "ficha" dele no banco automaticamente
        const db = getFirestore(app);
        await setDoc(doc(db, "assinaturas", user.uid), {
            status: "bloqueado",
            email: email
        });

        window.location.replace("bloqueado.html");
    } catch (e) {
        // Se der erro (ex: e-mail j√° existe), avisa o usu√°rio
        console.error("Erro na cria√ß√£o:", e.code);
        if (e.code === 'auth/email-already-in-use') {
            alert("Este e-mail j√° est√° em uso. Tente fazer login.");
        } else {
            alert("Erro ao criar conta: " + e.message);
        }
    }
}; 
 window.sair = () => signOut(auth);
 // O "Olho que tudo v√™" agora tamb√©m verifica o pagamento
onAuthStateChanged(auth, async (u) => { 
    if(u) { 
        usuarioAtual = u; 
        
        const db = getFirestore(app);
        const docRef = doc(db, "assinaturas", u.uid);
        
        try {
            const docSnap = await getDoc(docRef);
            
            if (docSnap.exists() && docSnap.data().status === "ativo") {
                // SUCESSO! Esconde o login e mostra o painel
                document.getElementById('telaLogin').classList.remove('ativa'); 
                document.getElementById('telaDashboard').classList.add('ativa'); 
                
                carregarFilhos(); 
                montarGaleriaInfinita(); 
            } else {
                // BLOQUEADO! Desloga o usu√°rio da mem√≥ria do Firebase primeiro
                await signOut(auth); 
                
                // Agora sim, manda para a p√°gina de bloqueio
                window.location.replace("bloqueado.html");
            }
        } catch (erro) {
            console.error("Erro ao verificar o banco de dados:", erro);
            // Em caso de erro, tamb√©m desloga por seguran√ßa
            await signOut(auth);
            window.location.replace("bloqueado.html");
        }

    } else { 
        // USU√ÅRIO DESLOGADO! Mostra a tela de login normalmente
        document.getElementById('telaLogin').classList.add('ativa'); 
        document.getElementById('telaDashboard').classList.remove('ativa'); 
    } 
});
        
        window.atualizarPreview = () => { const range = document.getElementById('rangeTamanho').value; const url = document.getElementById('imgAtividade').value; const img = document.getElementById('previewAvatar'); document.getElementById('labelTamanho').innerText = range + "px"; img.style.width = range + "px"; if(url && url.length > 5) img.src = url; };
        
        function carregarFilhos() { const sel = document.getElementById('selectFilho'); onSnapshot(collection(db, `usuarios/${usuarioAtual.uid}/filhos`), (s) => { sel.innerHTML=""; let tem=false; s.forEach(d=>{ tem=true; let o=document.createElement('option'); o.value=d.id; o.innerText=d.data().nome; sel.appendChild(o); }); if(!tem) novoFilho(); else { if(!filhoAtualId) filhoAtualId=sel.value; if(sel.querySelector(`option[value="${filhoAtualId}"]`)) sel.value=filhoAtualId; else { sel.value = sel.options[0].value; filhoAtualId = sel.value; } carregarDadosFilho(); } }); }
        
        window.novoFilho = async () => { const n = prompt("Nome do Filho:"); if(!n) return; const c = Math.random().toString(36).substring(2,8).toUpperCase(); const r = await addDoc(collection(db, `usuarios/${usuarioAtual.uid}/filhos`), { nome: n, codigo_pareamento: c }); await setDoc(doc(db, "conexoes", c), { caminho_dados: `usuarios/${usuarioAtual.uid}/filhos/${r.id}` }); mudarFilho(); };
        window.excluirFilho = async () => { if(!filhoAtualId) return; if(confirm("Excluir perfil?")) { await deleteDoc(doc(db, `usuarios/${usuarioAtual.uid}/filhos`, filhoAtualId)); location.reload(); } };
        window.mudarFilho = () => { filhoAtualId=document.getElementById('selectFilho').value; carregarDadosFilho(); };
        
        function carregarDadosFilho() {
            if(!filhoAtualId) return;
            const base = `usuarios/${usuarioAtual.uid}/filhos/${filhoAtualId}`;
            getDoc(doc(db, base)).then(d => { if(d.exists()) document.getElementById('displayCodigo').innerText=d.data().codigo_pareamento; });
            
            if(unsubscribeDispositivos) unsubscribeDispositivos();
            if(unsubscribeAtividades) unsubscribeAtividades();
            if(unsubscribeRotinas) unsubscribeRotinas();
            if(unsubscribeHistorico) unsubscribeHistorico();

            // 1. MONITORAMENTO (Tempo de Hoje Real)
            unsubscribeDispositivos = onSnapshot(collection(db, `${base}/dispositivos`), (snap) => {
                const boxSelect = document.getElementById('listaDispositivos');
                const boxMonitor = document.getElementById('painelMonitoramento');
                let htmlSelect = `<label class="device-label"><input type="checkbox" id="dev_todos" value="todos" checked> <b>Todos</b></label>`;
                let htmlMonitor = "";
                if(snap.empty) {
                    htmlSelect += `<div style="padding:10px; color:#999; font-size:11px">Aguardando PC...</div>`;
                    htmlMonitor = `<div style="padding:20px; text-align:center; color:#999">Nenhum computador conectado.</div>`;
                } else {
                    let devices = [];
                    snap.forEach(d => { let obj = d.data(); obj.id = d.id; devices.push(obj); });
                    devices.sort((a,b) => (b.online?.toDate() || 0) - (a.online?.toDate() || 0));
                    devices.forEach(dev => {
                        const isOnline = dev.online && (new Date() - dev.online.toDate() < 120000);
                        const statusDot = isOnline ? "üü¢" : "‚ö™";
                        let tempoDiario = "--";
                        if(dev.tempo_hoje_minutos !== undefined) {
                            const h = Math.floor(dev.tempo_hoje_minutos / 60);
                            const m = dev.tempo_hoje_minutos % 60;
                            tempoDiario = `${h}h ${m}m`;
                        }
                        htmlSelect += `<label class="device-label"><input type="checkbox" name="dev_item" value="${dev.id}"> ${statusDot} ${dev.nome || "PC"}</label>`;
                        htmlMonitor += `<div class="pc-status-card" style="border-left: ${isOnline ? '3px solid #2ecc71' : '1px solid #ccc'}"><div class="pc-info"><h3>üíª ${dev.nome || "Computador"}</h3><span class="pc-badge ${isOnline ? 'badge-online' : 'badge-offline'}">${isOnline ? 'ONLINE' : 'OFFLINE'}</span></div><div style="display:flex; align-items:center;"><div class="pc-timer" style="margin-right:15px; text-align:right;"><small>USO NO DIA</small><span>${tempoDiario}</span></div><button class="btn-del-device" onclick="apagarDispositivo('${dev.id}')" title="Remover">üóëÔ∏è</button></div></div>`;
                    });
                }
                boxSelect.innerHTML = htmlSelect;
                boxMonitor.innerHTML = htmlMonitor;
            });

            // 2. HIST√ìRICO COM ACUMULADO MENSAL
            const histRef = query(collection(db, `${base}/historico_uso`), orderBy("data", "desc"), limit(31));
            unsubscribeHistorico = onSnapshot(histRef, (snap) => {
                const box = document.getElementById('graficoHistorico');
                if(snap.empty) { box.innerHTML = "<small>Sem hist√≥rico.</small>"; return; }
                let dados = [];
                let totalMinutosMes = 0;
                const mesAtual = new Date().toISOString().slice(0, 7);
                snap.forEach(d => {
                    const dia = d.data();
                    if(dia.data.startsWith(mesAtual)) totalMinutosMes += (dia.minutos || 0);
                    dados.push(dia);
                });
                const hTotal = Math.floor(totalMinutosMes / 60);
                const mTotal = totalMinutosMes % 60;
                const metaInfo = `| Acumulado no M√™s: ${hTotal}h ${mTotal}m`;
                let html = "";
                let dadosGrafico = dados.slice(0, 7).reverse();
                let max = Math.max(...dadosGrafico.map(d => d.minutos), 1);
                dadosGrafico.forEach(d => {
                    const altura = Math.max(5, (d.minutos / max) * 100);
                    const diaFormat = d.data.split('-')[2] + '/' + d.data.split('-')[1];
                    const valorLabel = d.minutos > 60 ? (d.minutos / 60).toFixed(1) + 'h' : d.minutos + 'm';
                    html += `<div class="barra-wrapper"><div class="barra-valor">${valorLabel}</div><div class="barra" style="height:${altura}px"></div><div class="barra-dia">${diaFormat}</div></div>`;
                });
                box.innerHTML = html;
                const tituloHist = document.getElementById('tituloHistorico');
                if(tituloHist) tituloHist.innerHTML = `üìä Hist√≥rico de Uso <small style="float:right; color:#3498db;">${metaInfo}</small>`;
            });

            // 3. ATIVIDADES
            unsubscribeAtividades = onSnapshot(collection(db, `${base}/atividades`), (snap) => { 
                const l=document.getElementById('listaAtividades'); const s=document.getElementById('selectAtividadeRotina'); const g=document.getElementById('gridAcoes'); 
                l.innerHTML=""; s.innerHTML=""; g.innerHTML=""; cacheAtividades={}; 
                snap.forEach(d => { 
                    const dd=d.data(); cacheAtividades[d.id]=dd; 
                    l.innerHTML+=`<li><div style="display:flex; align-items:center"><img src="${dd.imagem}" class="img-mini" onerror="this.style.display='none'"> <b>${d.id}</b></div><div><button class="btn-edit" onclick="carregarEdicaoAtividade('${d.id}')">‚úèÔ∏è</button><button class="btn-red" onclick="apagarAtividade('${d.id}')">X</button></div></li>`; 
                    let o=document.createElement('option'); o.value=d.id; o.innerText=d.id; s.appendChild(o); 
                    g.innerHTML+=`<div style="text-align:center; border:1px solid #eee; padding:5px; border-radius:8px; cursor:pointer; background:#fdfdfd" onclick="enviarAcao('${d.id}')"><img src="${dd.imagem}" style="width:30px; height:30px; object-fit:contain; margin:0 auto"><br><small style="font-weight:bold">${d.id}</small></div>`; 
                });
                renderizarTimeline();
            });

            // 4. ROTINAS
            unsubscribeRotinas = onSnapshot(collection(db, `${base}/rotinas`), (snap) => { 
                const c=document.getElementById('calendarioContainer'); c.innerHTML=""; 
                const dias=["DOM","SEG","TER","QUA","QUI","SEX","S√ÅB"]; 
                for(let i=0; i<7; i++) c.innerHTML+=`<div class="dia-coluna" id="col-${i}"><div style="text-align:center; font-weight:bold; color:#3498db; border-bottom:1px solid #eee; padding-bottom:5px; margin-bottom:5px">${dias[i]}</div></div>`; 
                cacheRotinas = {}; 
                snap.forEach(d => { 
                    const r=d.data(); cacheRotinas[d.id]=r; 
                    const h=`<div class="card-rotina"><b>${r.hora}</b> ${r.acao}<div style="text-align:right; margin-top:4px"><button class="btn-edit" onclick="carregarEdicaoRotina('${d.id}')">‚úèÔ∏è</button><button class="btn-red" onclick="apagarRotina('${d.id}')">X</button></div></div>`; 
                    if(r.dia_semana==='todos') { for(let i=0;i<7;i++) document.getElementById(`col-${i}`).innerHTML+=h; } 
                    else { try{document.getElementById(`col-${r.dia_semana}`).innerHTML+=h}catch(e){} } 
                });
                renderizarTimeline(); 
            });
        }

        function renderizarTimeline() {
            const container = document.getElementById('timelineInteligente');
            if(!container) return;
            container.innerHTML = "";
            const hoje = new Date();
            const diaSemana = hoje.getDay().toString();
            const horaAtual = hoje.getHours() * 60 + hoje.getMinutes();
            let rotinasHoje = Object.values(cacheRotinas).filter(r => r.dia_semana === 'todos' || r.dia_semana === diaSemana).sort((a,b) => a.hora.localeCompare(b.hora));
            if(rotinasHoje.length === 0) { container.innerHTML = "<p style='color:#999; text-align:center'>Sem rotinas hoje.</p>"; return; }
            let proxMarked = false;
            rotinasHoje.forEach(r => {
                const [h, m] = r.hora.split(':').map(Number);
                const minutos = h * 60 + m;
                let cl = minutos < horaAtual ? "passado" : (!proxMarked ? (proxMarked=true, "proximo") : "futuro");
                const atv = cacheAtividades[r.acao] || {};
                container.innerHTML += `<div class="tl-item ${cl}"><div class="tl-time">${r.hora}</div><div class="tl-content"><img src="${atv.imagem||''}" class="tl-img"><div class="tl-text"><b>${r.acao} <small>${cl==='proximo'?'‚è≥':''}</small></b><span>${atv.texto||''}</span></div></div></div>`;
            });
        }


  
        window.carregarEdicaoAtividade = (id) => { const d = cacheAtividades[id]; if(!d) return; document.getElementById('idAtividade').value = id; document.getElementById('idAtividade').disabled = true; document.getElementById('editIdAtividade').value = id; document.getElementById('txtAtividade').value = d.texto||""; document.getElementById('imgAtividade').value = d.imagem||""; document.getElementById('tempoAtividade').value = d.tempo_personalizado||""; document.getElementById('rangeTamanho').value = d.tamanho_avatar||"150"; atualizarPreview(); document.getElementById('txt5min').value = d.texto_5min||""; document.getElementById('txt3min').value = d.texto_3min||""; document.getElementById('posAtividade').value = d.posicao_especifica||""; document.getElementById('checkVoz').checked = (d.falar_texto!==false); document.getElementById('checkBlock').checked = (d.bloquear_tela===true); document.getElementById('generoVoz').value = d.genero_voz || "M";};
        window.limparFormAtividade = () => { document.getElementById('idAtividade').disabled = false; document.getElementById('idAtividade').value = ""; document.getElementById('editIdAtividade').value = ""; document.querySelectorAll('input[type=text], input[type=number]').forEach(i=>i.value=""); document.getElementById('rangeTamanho').value="150"; atualizarPreview(); };
      // --- FUN√á√ÉO DE SALVAR ATIVIDADE (QUE ESTAVA FALTANDO) ---
     window.salvarAtividade = async () => { 
    const id = document.getElementById('idAtividade').value.toLowerCase().replace(/\s/g,''); 
    if(!id) return alert("Por favor, preencha o ID (Nome Curto) da atividade."); 
    
    const textoAviso = document.getElementById('txtAtividade').value;
    const falarTexto = document.getElementById('checkVoz').checked;
    const bloquearTela = document.getElementById('checkBlock').checked;
    const genero = document.getElementById('generoVoz').value;

    let audioGerado = ""; // Vai guardar o MP3

    // SE O PAI QUER QUE FALE, GERAMOS O √ÅUDIO AGORA NO GOOGLE!
    if (falarTexto && textoAviso) {
        const API_KEY = "AIzaSyBSvEoSv8FgmCfedisR2qAsQYdPq5ADQfI"; // SUA CHAVE ATIVA
        const nomeVoz = (genero === 'M') ? 'pt-BR-Neural2-B' : 'pt-BR-Neural2-C';
        const tomVoz = (genero === 'M') ? -1.0 : 2.0;

        try {
            const resposta = await fetch(`https://texttospeech.googleapis.com/v1/text:synthesize?key=${API_KEY}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    input: { text: textoAviso },
                    voice: { languageCode: "pt-BR", name: nomeVoz },
                    audioConfig: { audioEncoding: "MP3", pitch: tomVoz, speakingRate: 1.15 }
                })
            });
            const dados = await resposta.json();
            if (dados.audioContent) {
                audioGerado = dados.audioContent; 
            } else {
                console.error("Resposta do Google sem √°udio:", dados);
            }
        } catch(e) {
            console.error("Erro ao gerar √°udio:", e);
        }
    }

    // SALVA NO FIREBASE (COM O √ÅUDIO E O G√äNERO)
    await setDoc(doc(db, `usuarios/${usuarioAtual.uid}/filhos/${filhoAtualId}/atividades`, id), { 
        texto: textoAviso, 
        imagem: document.getElementById('imgAtividade').value, 
        tempo_personalizado: document.getElementById('tempoAtividade').value, 
        tamanho_avatar: document.getElementById('rangeTamanho').value, 
        texto_5min: document.getElementById('txt5min').value, 
        texto_3min: document.getElementById('txt3min').value, 
        imagem_5min: document.getElementById('img5min').value, 
        imagem_3min: document.getElementById('img3min').value, 
        posicao_especifica: document.getElementById('posAtividade').value, 
        falar_texto: falarTexto, 
        bloquear_tela: bloquearTela,
        genero_voz: genero,
        audio_base64: audioGerado
    }); 
    
    alert("‚úÖ Salvo com sucesso!"); 
    limparFormAtividade(); 
};
        window.salvarRotina = async () => { const h=document.getElementById('horaRotina').value; const id=document.getElementById('editIdRotina').value; if(!h)return; const d={hora:h, dia_semana:document.getElementById('diaRotina').value, acao:document.getElementById('selectAtividadeRotina').value}; if(id) await updateDoc(doc(db,`usuarios/${usuarioAtual.uid}/filhos/${filhoAtualId}/rotinas`,id),d); else await addDoc(collection(db,`usuarios/${usuarioAtual.uid}/filhos/${filhoAtualId}/rotinas`),d); document.getElementById('editIdRotina').value=""; document.getElementById('horaRotina').value=""; };
        window.carregarEdicaoRotina = (id) => { const r=cacheRotinas[id]; if(!r)return; document.getElementById('editIdRotina').value=id; document.getElementById('horaRotina').value=r.hora; document.getElementById('diaRotina').value=r.dia_semana; document.getElementById('selectAtividadeRotina').value=r.acao; };
        window.apagarAtividade = async(id) => { if(confirm("Apagar?")) await deleteDoc(doc(db, `usuarios/${usuarioAtual.uid}/filhos/${filhoAtualId}/atividades`, id)); };
        window.apagarRotina = async(id) => { if(confirm("Apagar?")) await deleteDoc(doc(db, `usuarios/${usuarioAtual.uid}/filhos/${filhoAtualId}/rotinas`, id)); };
        window.enviarAcao = async(a) => { if(!filhoAtualId) return alert("Selecione um filho"); await setDoc(doc(db, `usuarios/${usuarioAtual.uid}/filhos/${filhoAtualId}/config/estado_atual`), {acao:a, timestamp:new Date()}, {merge:true}); mostrarAviso(); };
        window.apagarDispositivo = async(id) => { if(confirm("Remover este computador?")) await deleteDoc(doc(db, `usuarios/${usuarioAtual.uid}/filhos/${filhoAtualId}/dispositivos`, id)); };
        window.abrirDicas = () => document.getElementById('modalDicas').classList.add('aberta');
        window.fecharDicas = () => document.getElementById('modalDicas').classList.remove('aberta');

        function montarGaleriaInfinita() {
    const container = document.getElementById('galVisual');
    if(!container) return; 
    container.innerHTML = "";
    
    // Lista de nomes base
    const nomes = ["ARRUMANDO_CAMA", "BANHO", "BOCEJANDO", "COMER", "DESLIGAR-PC", "LIGAR-PC", "ESCOVANDO_DENTES"];
    // Adiciona n√∫meros de 1 a 50
    for(let i=1; i<=50; i++) nomes.push(`${i}`); 

    nomes.forEach(nomeBase => {
        // Tenta todas as extens√µes poss√≠veis
        [".gif", ".png", ".jpg", ".GIF", ".PNG", ".JPG"].forEach(ext => {
            
            const nomeArq = nomeBase.includes('.') ? nomeBase : nomeBase + ext;
            const img = new Image();
            img.src = `IMG/${nomeArq}`;
            img.className = 'img-sel';
            
            // Colocamos uma etiqueta √∫nica na imagem
            img.setAttribute('data-id', nomeBase); 

            img.onload = () => { 
                // Verificamos se j√° existe algu√©m com essa ETIQUETA EXATA
                if(!container.querySelector(`img[data-id="${nomeBase}"]`)) { 
                    img.classList.add('visivel'); 
                    container.appendChild(img); 
                }
            };

            img.onclick = () => {
                document.querySelectorAll('.img-sel').forEach(i => i.classList.remove('ativa'));
                img.classList.add('ativa'); 
                document.getElementById('imgAtividade').value = img.src; 
                window.atualizarPreview();
            };
        });
    });
}
// Fun√ß√£o para mostrar o aviso flutuante
    window.mostrarAviso = (mensagem) => {
        const toast = document.getElementById("toast-aviso");
        
        // Se voc√™ quiser passar uma mensagem diferente, ele muda. Se n√£o, usa a padr√£o.
        if (mensagem) {
            toast.innerText = "ü§ñ " + mensagem;
        } else {
            toast.innerText = "ü§ñ A√ß√£o enviada para o dispositivo!";
        }

        // Faz aparecer
        toast.classList.add("mostrar");

        // Conta 3 segundos (3000 milissegundos) e faz sumir sozinho
        setTimeout(() => {
            toast.classList.remove("mostrar");
        }, 3000);
    };

    // Primeiro, garanta que a fun√ß√£o de redefini√ß√£o est√° sendo importada do Firebase l√° no topo do arquivo (junto com o signInWithEmailAndPassword):
// import { sendPasswordResetEmail } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js"; 

// Captura o clique no bot√£o de Esqueci a Senha
document.getElementById('btnEsqueciSenha').addEventListener('click', function(event) {
    event.preventDefault(); // Evita que a p√°gina recarregue do zero

    // Pega o e-mail que o pai digitou na caixinha de login
    // ATEN√á√ÉO: Troque 'id-do-seu-campo-email' pelo ID real que voc√™ usa no seu HTML
    const emailDigitado = document.getElementById('emailInput').value;

    // Verifica se o campo est√° vazio
    if (!emailDigitado) {
        alert("Por favor, digite o seu e-mail na caixinha acima para recuperar a senha!");
        return;
    }

    // Pede para o Firebase mandar o e-mail m√°gico
    sendPasswordResetEmail(auth, emailDigitado)
        .then(() => {
            // Deu certo!
            alert("Sucesso! Um e-mail de recupera√ß√£o foi enviado para: " + emailDigitado + "\n\nVerifique sua caixa de entrada (e tamb√©m a pasta de Spam/Lixo Eletr√¥nico).");
        })
        .catch((error) => {
            // Deu erro (ex: e-mail n√£o existe no banco de dados)
            const codigoErro = error.code;
            if (codigoErro === 'auth/user-not-found') {
                alert("Nenhuma conta encontrada com este e-mail.");
            } else if (codigoErro === 'auth/invalid-email') {
                alert("Por favor, digite um e-mail v√°lido.");
            } else {
                alert("Ocorreu um erro: " + error.message);
            }
        });
});
window.toggleSenha = function() {
    const inputSenha = document.getElementById('senhaInput');
    const botaoOlhinho = document.getElementById('btnOlhinho');

    if (inputSenha.type === 'password') {
        // Se est√° escondida, mostra o texto e troca o √≠cone
        inputSenha.type = 'text';
        botaoOlhinho.innerText = 'üôà'; // √çcone de olho fechado ou macaco escondendo
    } else {
        // Se est√° aparecendo, volta a esconder
        inputSenha.type = 'password';
        botaoOlhinho.innerText = 'üëÅÔ∏è'; // √çcone de olho aberto
    }
};
 </script>
</body>

</html>

